(()=>{"use strict";class e{constructor(e,a){this.suit=e,this.rank=a}}class a{constructor(){this.cards=[]}createDeck(){const a=["C","D","H","S"],t=["2","3","4","5","6","7","8","9","10","J","Q","K","A"];for(let s=0;s<a.length;s++)for(let r=0;r<t.length;r++)this.cards.push(new e(a[s],t[r]))}deal(){return this.cards.splice(Math.floor(Math.random()*this.cards.length),1)[0]}}class t{constructor(e){this.playerName=e,this.playerCards=[]}addCard(e){this.playerCards.push(e)}calcTotal(){let e=0;for(let a=0;a<this.playerCards.length;a++){let t=this.playerCards[a];"A"===t.rank?e+=e+11<=21?11:1:"J"===t.rank||"Q"===t.rank||"K"===t.rank?e+=10:e+=Number(t.rank)}return e}}class s{constructor(){this.players=[],this.deck=new a}start(e,a,s){const r=new t(e),n=new t(a);this.players.push(r),this.players.push(n),this.deck.createDeck();for(let e=0;e<s;e++)r.addCard(this.deck.deal()),n.addCard(this.deck.deal());this.players.forEach((e=>{this.renderInitialHands(e)}))}suitIcon(e){let a;switch(e){case"H":a="&#9829;";break;case"D":a="&#9830;";break;case"S":a="&#9824;";break;case"C":a="&#9827;"}return a}renderInitialHands(e){const a=document.querySelector(".dealerHand"),t=document.querySelector(".playerHand");let s=e.playerCards,r=e.playerName;""==!t.innerHTML&&""==!a.innerHTML&&(t.innerHTML="",a.innerHTML="");for(let n=0;n<s.length;n++){let i=!1;const l=document.createElement("div");l.classList.add("cardHolder");let d=s[n].suit,c=s[n].rank;"Dealer"===e.playerName&&0===n&&(i=!0),l.appendChild(this.renderCard(d,c,i)),"Dealer"===r?a.appendChild(l):t.appendChild(l)}}newCard(e){const a=document.createElement("div"),t=document.querySelector(".dealerHand"),s=document.querySelector(".playerHand"),r=e.playerName,n=this.deck.deal(),i=n.suit,l=n.rank;a.classList.add("cardHolder"),e.addCard(n),a.appendChild(this.renderCard(i,l)),"Dealer"===r?t.appendChild(a):s.appendChild(a)}renderCard(e,a,t){const s=document.createElement("div"),r=document.createElement("div");if(1==t&&s.classList.add("flipCard","in_animation",e,a),s.classList.add("card","in_animation",e,a),"A"===a||"K"===a||"Q"===a||"J"===a)s.innerHTML="A"===a?`<div class="card-value-suit top"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>\n                        <div class="card-suit ${e} ${a}"> ${this.suitIcon(e)} </div>\n                        <div class="card-value-suit bot"><span>${a}</span> <span>${this.suitIcon(e)}</span></div>`:`<div class="card-value-suit top"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>\n                        <div class="card-suit ${a}"> ${a} </div>\n                        <div class="card-value-suit bot"><span>${a}</span> <span>${this.suitIcon(e)}</span></div>`;else{r.classList.add("card-suit",a),s.innerHTML=`<div class="card-value-suit top"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>`;for(let t=0;t<Number(a);t++)r.innerHTML+=`<span>${this.suitIcon(e)}</span>`;s.appendChild(r),s.innerHTML+=`<div class="card-value-suit bot"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>`}return s}}!function(){const e=document.querySelector(".deal"),a=document.querySelector(".hit"),t=document.querySelector(".stay"),r=document.querySelector(".reDeal"),n=document.querySelector(".gameArea"),i=document.querySelector(".scoreArea"),l=document.querySelector(".dealerHand"),d=document.querySelector(".playerHand"),c=document.querySelector(".headArea"),o=document.getElementById("dealerScore"),u=document.getElementById("playerScore"),p=document.getElementById("resetScoreButton");let L,h,m,y,g,v,H,S=parseInt(localStorage.getItem("playerWins")),T=parseInt(localStorage.getItem("dealerWins"));function M(){c.classList.add("hiddenArea"),a.disabled=!1,t.disabled=!1,a.classList.remove("greyOut"),t.classList.remove("winButton"),t.classList.remove("greyOut"),d.innerHTML="",l.innerHTML="",n.classList.remove("hiddenArea"),n.classList.add("gameArea"),r.classList.add("hiddenArea"),L=new s,L.start("Player","Dealer",2),h=L.players[0],m=L.players[1],y=h.calcTotal(),g=m.calcTotal(),21===y&&g<21?(i.innerHTML="Natural 21! You win!",a.disabled=!0,a.classList.add("greyOut"),t.classList.add("greyOut"),t.disabled=!0,r.classList.remove("hiddenArea"),I(),v+=1,o.innerHTML=H,u.innerHTML=v,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",H.toString())):i.innerHTML=21===y&&21===g?"Push "+C(y,g):`Player current score: ${y}`}function C(e,s){t.disabled=!0,a.disabled=!0;let r=e.calcTotal(),n=s.calcTotal();return a.classList.add("greyOut"),t.classList.add("greyOut"),r>21&&n>21?(o.innerHTML=H,u.innerHTML=v,"Both players bust"):r>21?(H+=1,o.innerHTML=H,u.innerHTML=v,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",H.toString()),"Dealer wins with: "+n+" vs "+r):n>21?(v+=1,o.innerHTML=H,u.innerHTML=v,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",H.toString()),"Player 1 wins with: "+r+" vs "+n):r>n?(v+=1,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",H.toString()),"Player 1 wins with: "+r+" vs "+n):n>r?(H+=1,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",H.toString()),o.innerHTML=H,u.innerHTML=v,"Dealer wins with: "+n+" vs "+r):"Tie"}function I(){for(document.querySelector(".flipCard").classList.remove("flipCard");m.calcTotal()<17||m.calcTotal<h.calcTotal;)L.newCard(m)}T||S?(console.log("saved score"),v=S,H=T,o.innerHTML=H,u.innerHTML=v):(v=0,H=0),n.classList.remove("gameArea"),n.classList.add("hiddenArea"),e.addEventListener("click",M),r.addEventListener("click",M),a.addEventListener("click",(()=>{L.newCard(h),y=h.calcTotal(),21===y?(a.disabled=!0,a.classList.add("greyOut"),t.disabled=!0,t.classList.add("greyOut"),r.classList.remove("hiddenArea"),I(),i.innerHTML="Blackjack! -- "+C(h,m),o.innerHTML=H,u.innerHTML=v):y>21?(document.querySelector(".flipCard").classList.remove("flipCard"),a.disabled=!0,a.classList.add("greyOut"),t.classList.add("greyOut"),t.disabled=!0,r.classList.remove("hiddenArea"),i.innerHTML=`You bust! ${C(h,m)}!`):i.innerHTML=`Your current score: ${y}`})),t.addEventListener("click",(()=>{a.disabled=!0,a.classList.add("greyOut"),I();let e=C(h,m);o.innerHTML=H,u.innerHTML=v,i.innerHTML=e,r.classList.remove("hiddenArea")})),p.addEventListener("click",(()=>{localStorage.clear("playerWins"),localStorage.clear("dealerWins"),H=0,v=0,o.innerHTML=H,u.innerHTML=v}))}()})();