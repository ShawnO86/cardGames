(()=>{"use strict";class e{constructor(e,a){this.suit=e,this.rank=a}}class a{constructor(){this.cards=[]}createDeck(){const a=["C","D","H","S"],t=["2","3","4","5","6","7","8","9","10","J","Q","K","A"];for(let s=0;s<a.length;s++)for(let r=0;r<t.length;r++)this.cards.push(new e(a[s],t[r]))}deal(){return this.cards.splice(Math.floor(Math.random()*this.cards.length),1)[0]}}class t{constructor(e){this.playerName=e,this.playerCards=[]}addCard(e){this.playerCards.push(e)}calcTotal(){let e=0,a=!1;for(let t=0;t<this.playerCards.length;t++){let s=this.playerCards[t];"A"===s.rank?a=!0:"J"===s.rank||"Q"===s.rank||"K"===s.rank?e+=10:e+=Number(s.rank)}return a&&(e+=e+11<=21?11:1),e}}class s{constructor(){this.players=[],this.deck=[]}start(e,s,r){const n=new t(e),i=new t(s);this.players.push(n),this.players.push(i);let l=new a;l.createDeck(),this.deck=l;for(let e=0;e<r;e++)n.addCard(l.deal()),i.addCard(l.deal());this.players.forEach((e=>{this.renderInitialHands(e)}))}suitIcon(e){let a;switch(e){case"H":a="&#9829;";break;case"D":a="&#9830;";break;case"S":a="&#9824;";break;case"C":a="&#9827;"}return a}renderInitialHands(e){const a=document.querySelector(".dealerHand"),t=document.querySelector(".playerHand");let s=e.playerCards,r=e.playerName;""==!t.innerHTML&&""==!a.innerHTML&&(t.innerHTML="",a.innerHTML="");for(let n=0;n<s.length;n++){let i=!1;const l=document.createElement("div");l.classList.add("cardHolder");let d=s[n].suit,c=s[n].rank;"Dealer"===e.playerName&&0===n&&(i=!0),l.appendChild(this.renderCard(d,c,i)),"Dealer"===r?a.appendChild(l):t.appendChild(l)}}newCard(e){const a=document.createElement("div"),t=document.querySelector(".dealerHand"),s=document.querySelector(".playerHand"),r=e.playerName,n=this.deck.deal(),i=n.suit,l=n.rank;a.classList.add("cardHolder"),e.addCard(n),a.appendChild(this.renderCard(i,l)),"Dealer"===r?t.appendChild(a):s.appendChild(a)}renderCard(e,a,t){const s=document.createElement("div"),r=document.createElement("div");if(1==t&&s.classList.add("flipCard","in_animation",e,a),s.classList.add("card","in_animation",e,a),"A"===a||"K"===a||"Q"===a||"J"===a)s.innerHTML="A"===a?`<div class="card-value-suit top"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>\n                        <div class="card-suit ${e} ${a}"> ${this.suitIcon(e)} </div>\n                        <div class="card-value-suit bot"><span>${a}</span> <span>${this.suitIcon(e)}</span></div>`:`<div class="card-value-suit top"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>\n                        <div class="card-suit ${a}"> ${a} </div>\n                        <div class="card-value-suit bot"><span>${a}</span> <span>${this.suitIcon(e)}</span></div>`;else{r.classList.add("card-suit",a),s.innerHTML=`<div class="card-value-suit top"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>`;for(let t=0;t<Number(a);t++)r.innerHTML+=`<span>${this.suitIcon(e)}</span>`;s.appendChild(r),s.innerHTML+=`<div class="card-value-suit bot"> <span>${a}</span> <span>${this.suitIcon(e)}</span></div>`}return s}}!function(){const e=document.querySelector(".deal"),a=document.querySelector(".hit"),t=document.querySelector(".stay"),r=document.querySelector(".reDeal"),n=document.querySelector(".gameArea"),i=document.querySelector(".scoreArea"),l=document.querySelector(".dealerHand"),d=document.querySelector(".playerHand"),c=document.querySelector(".headArea"),o=document.getElementById("dealerScore"),u=document.getElementById("playerScore");let p,h,L,m,y,v,g,H=parseInt(localStorage.getItem("playerWins")),T=parseInt(localStorage.getItem("dealerWins"));function S(){c.classList.add("hiddenArea"),a.disabled=!1,t.disabled=!1,a.classList.remove("greyOut"),t.classList.remove("winButton"),t.classList.remove("greyOut"),d.innerHTML="",l.innerHTML="",n.classList.remove("hiddenArea"),n.classList.add("gameArea"),r.classList.add("hiddenArea"),p=new s,p.start("Player","Dealer",2),h=p.players[0],L=p.players[1],m=h.calcTotal(),y=L.calcTotal(),21===m&&y<21?(i.innerHTML="Natural 21! You win!",a.disabled=!0,a.classList.add("greyOut"),t.classList.add("greyOut"),t.disabled=!0,r.classList.remove("hiddenArea"),C(),v+=1,o.innerHTML=g,u.innerHTML=v,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",g.toString())):i.innerHTML=21===m&&21===y?"Push "+M(m,y):`Player current score: ${m}`,n.scrollIntoView({behavior:"smooth",block:"end"})}function M(e,s){t.disabled=!0,a.disabled=!0;let r=e.calcTotal(),n=s.calcTotal();return a.classList.add("greyOut"),t.classList.add("greyOut"),r>21&&n>21?(o.innerHTML=g,u.innerHTML=v,"Both players bust"):r>21?(g+=1,o.innerHTML=g,u.innerHTML=v,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",g.toString()),"Dealer wins with: "+n+" vs "+r):n>21?(v+=1,o.innerHTML=g,u.innerHTML=v,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",g.toString()),"Player 1 wins with: "+r+" vs "+n):r>n?(v+=1,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",g.toString()),"Player 1 wins with: "+r+" vs "+n):n>r?(g+=1,localStorage.setItem("playerWins",v.toString()),localStorage.setItem("dealerWins",g.toString()),o.innerHTML=g,u.innerHTML=v,"Dealer wins with: "+n+" vs "+r):"Tie"}function C(){for(document.querySelector(".flipCard").classList.remove("flipCard");L.calcTotal()<17||L.calcTotal<h.calcTotal;)p.newCard(L)}T||H?(console.log("saved score"),v=H,g=T,o.innerHTML=g,u.innerHTML=v):(v=0,g=0),n.classList.remove("gameArea"),n.classList.add("hiddenArea"),e.addEventListener("click",S),r.addEventListener("click",S),a.addEventListener("click",(()=>{p.newCard(h),m=h.calcTotal(),21===m?(a.disabled=!0,a.classList.add("greyOut"),t.disabled=!0,t.classList.add("greyOut"),r.classList.remove("hiddenArea"),C(),i.innerHTML="Blackjack! -- "+M(h,L),o.innerHTML=g,u.innerHTML=v):m>21?(document.querySelector(".flipCard").classList.remove("flipCard"),a.disabled=!0,a.classList.add("greyOut"),t.classList.add("greyOut"),t.disabled=!0,r.classList.remove("hiddenArea"),i.innerHTML=`You bust! ${M(h,L)}!`):i.innerHTML=`Your current score: ${m}`})),t.addEventListener("click",(()=>{a.disabled=!0,a.classList.add("greyOut"),C();let e=M(h,L);o.innerHTML=g,u.innerHTML=v,i.innerHTML=e,r.classList.remove("hiddenArea")}))}()})();